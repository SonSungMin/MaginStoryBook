<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마법 그림책 - 관리자 페이지</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="admin.css">
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Pen+Script&family=Jua&display=swap" rel="stylesheet">
</head>
<body>
    <div id="admin-login-container" class="login-container">
        <h2>관리자 로그인</h2>
        <input type="text" id="adminId" placeholder="관리자 ID" value="admin">
        <input type="password" id="adminPwd" placeholder="비밀번호" value="admin">
        <button id="adminLoginButton" class="btn-login">로그인</button>
    </div>

    <div id="admin-main-content" style="display: none;">
        <div class="admin-header">
            <div class="container">
                <h1><img src="images/magic_storybook_logo_english.png" class="admin-logo"> 관리자 페이지</h1>
                <button id="adminLogoutButton" class="btn-back-to-login"><i class="fas fa-sign-out-alt"></i> 로그아웃</button>
            </div>
        </div>
        
        <!-- MODALS -->
        <div id="editMemberModal" class="modal">
            <!-- ... (기존과 동일) ... -->
        </div>
        <div id="editEstablishmentModal" class="modal">
            <!-- ... (기존과 동일) ... -->
        </div>
        <div id="editThemeModal" class="modal">
            <!-- ... (기존과 동일) ... -->
        </div>

        <!-- NEW: Storybook Production Modal -->
        <div id="productionModal" class="modal">
            <div class="modal-content large-modal">
                <span class="close-button" id="closeProductionModal">&times;</span>
                <h2>동화책 제작</h2>
                <input type="hidden" id="productionStoryId">
                <div class="production-area">
                    <div class="production-section">
                        <h3>앞표지</h3>
                        <div class="cover-upload-area">
                            <img id="coverPreview" src="images/placeholder_preview.png" alt="앞표지 미리보기">
                            <label for="coverUploadInput" class="btn-secondary">표지 이미지 선택</label>
                            <input type="file" id="coverUploadInput" accept="image/*" style="display:none;">
                        </div>
                    </div>
                    <div class="production-section">
                        <h3>내지</h3>
                        <div id="contentPagesContainer" class="content-pages-container">
                            <!-- JS will add pages here -->
                        </div>
                        <button id="addPageButton" class="btn-primary"><i class="fas fa-plus"></i> 페이지 추가</button>
                    </div>
                </div>
                <div class="button-group">
                    <button class="btn-secondary" onclick="document.getElementById('productionModal').style.display='none'">취소</button>
                    <button id="saveStorybookButton" class="btn-primary">제작 완료</button>
                </div>
            </div>
        </div>

        <!-- NEW: Storybook Viewer Modal -->
        <div id="storybookViewerModal" class="modal viewer-modal">
            <div class="modal-content large-modal">
                <span class="close-button" id="closeViewerModal">&times;</span>
                <div class="storybook-viewer">
                    <div class="viewer-page left">
                        <img id="viewerImage" src="">
                    </div>
                    <div class="viewer-page right">
                        <p id="viewerText"></p>
                    </div>
                </div>
                <div class="viewer-controls">
                    <button id="prevPageButton"><i class="fas fa-arrow-left"></i> 이전</button>
                    <span id="pageIndicator"></span>
                    <button id="nextPageButton">다음 <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
        </div>
        
        <div class="admin-container container">
            <div class="admin-nav">
                <button class="admin-nav-button active" data-target="manage-establishments">교육기관 관리</button>
                <button class="admin-nav-button" data-target="manage-classes">반 관리</button>
                <button class="admin-nav-button" data-target="manage-themes">테마 관리</button>
                <button class="admin-nav-button" data-target="manage-members">구성원 관리</button>
                <button class="admin-nav-button" data-target="manage-permissions">권한 관리</button>
                <button class="admin-nav-button" data-target="storybook-maker">동화책 만들기</button>
            </div>

            <!-- ... (manage-establishments to manage-permissions sections are same) ... -->

            <section id="storybook-maker" class="admin-section">
                <h2>동화책 만들기</h2>
                <div class="data-list">
                    <h3>선생님들이 등록한 작품</h3>
                    <ul id="storybookMakerList">
                        <!-- JS will populate this list -->
                    </ul>
                </div>
            </section>
        </div>
    </div>

    <div class="version-footer"></div>
    <script src="js/config.js"></script>
    <script src="js/version-injector.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script type="module" src="./admin-initializer.js"></script>
</body>
</html>
